<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <script type="module">
        import { ethers } from "https://cdnjs.cloudflare.com/ajax/libs/ethers/6.13.1/ethers.js"; 
        const mainJson = await fetch('Main.json')
        .then(response => response.json())  
        .then( async (contractMainJson)=> {
            console.log(contractMainJson); 
            const abiMain = contractMainJson;
            console.log("abiMain",abiMain)
            const MainAddress = "0x171920C420A6e93EB65F37e072B6D8cA3383Aa9e";
            let signer = null;
            let provider;
            if (window.ethereum === null) {
              console.log("MetaMask not installed; using read-only defaults")
              provider = ethers.getDefaultProvider()
            }else {
              provider = new ethers.BrowserProvider(window.ethereum)
              signer = await provider.getSigner();
            }
            const accounts = await ethereum.request({ method: "eth_accounts" });
            const account = accounts[0]
            console.log(`钱包地址: ${account}`);
            try{
              const contractMain = new ethers.Contract(MainAddress, abiMain, signer);
              alert("1")
              try{
                alert("2")
                const TokenId = async()=>{
                  return await contractMain.mint(account,"http://ideaeye.com","http://ideaeye");
                }
                alert("3")
                const tokenId = await TokenId()
                alert(TokenId)
                console.log('debug',tokenId);
              }catch (error){
                console.error(error);
              }
            }catch(error){
              console.error(error);
            }
        })
    </script>
  </body>
</html>